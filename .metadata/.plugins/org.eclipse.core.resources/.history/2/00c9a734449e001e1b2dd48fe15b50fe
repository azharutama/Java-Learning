import java.io.*;
import java.util.Scanner;

public class FileNasabah {

    void SaveToFile() {
        int norek;
        String Nama;
        double saldo;
        String pin;
        Nasabah R;

        System.out.println("===== SaveToFile =====");

        try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream("C:\\DATAKU\\Nasabah.dat"))) {
            Scanner sc = new Scanner(System.in);

            while (true) {
                System.out.print("Masukan norek (999 to stop): ");
                norek = sc.nextInt();

                if (norek == 999) {
                    break;
                }

                System.out.print("Masukan Nama: ");
                Nama = sc.next();

                System.out.print("Masukan saldo: ");
                saldo = sc.nextDouble();

                System.out.print("Masukan pin: ");
                pin = sc.next();

                R = new Nasabah(norek, Nama, saldo, pin);
                out.writeObject(R);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    void BacaFile() {
        System.out.println("===== BacaFile =====");

        try (ObjectInputStream in = new ObjectInputStream(new FileInputStream("C:\\DATAKU\\Nasabah.dat"))) {
            int total = 0;
            Nasabah R;

            try {
                while (true) {
                    R = (Nasabah) in.readObject();
                    System.out.println("norek: " + R.getNorek());
                    System.out.println("Nama: " + R.getNama());
                    System.out.println("saldo: " + R.getSaldo());
                    total++;
                }
            } catch (EOFException e) {
                System.out.println("TOTAL= " + total);
            }
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }

    void LoginNasabah() {
        System.out.println("===== LoginNasabah =====");

        try (ObjectInputStream in = new ObjectInputStream(new FileInputStream("C:\\DATAKU\\Nasabah.dat"))) {
            boolean ketemu = false;
            Nasabah R = new Nasabah();

            try (Scanner sc = new Scanner(System.in)) {
                System.out.print("Masukan norek: ");
                int norekC = sc.nextInt();
                System.out.print("Masukan pin: ");
                String pinC = sc.next();

                while (true) {
                    R = (Nasabah) in.readObject();
                    if (R.getNorek() == norekC && R.getPin().equals(pinC)) {
                        ketemu = true;
                        break;
                    }
                }

                if (ketemu) {
                    System.out.println("Login berhasil!");
                } else {
                    System.out.println("Norek atau pin salah.");
                }
            } catch (EOFException e) {
                System.out.println("Akhir file. Tidak ketemu.");
            }

        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        FileNasabah F = new FileNasabah();
//        F.SaveToFile();
//        F.BacaFile();
        F.LoginNasabah();
    }
}

